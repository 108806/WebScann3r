# All patterns for Command Injection
patterns = [
    r'(?i)(?:exec|shell_exec|system|passthru|popen|proc_open)\s*\(\s*.*\$_(?:GET|POST|REQUEST|COOKIE)',
    r'(?i)(?:exec|shell_exec|system|passthru|popen|proc_open)\s*\(\s*.*\+',
    r'(?i)spawn\s*\(\s*.*\$_(?:GET|POST|REQUEST|COOKIE)',
    r'(?i)child_process\.exec\s*\(\s*.*\+',
    r'(?i)Runtime\.getRuntime\(\)\.exec\(.*\+',
    r'(?i)ProcessBuilder\(.*\+',
    r'(?i)os\.system\(.*\+',
    r'(?i)subprocess\.(?:call|Popen|run)\(.*\+',
    r'(?i)os\.system\s*\(\s*.*\)',
    r'(?i)subprocess\.(?:call|Popen|run)\s*\(\s*.*\)',
    r'(?i)commands\.getoutput\s*\(\s*.*\)',
    r'(?i)child_process\.(?:exec|spawn|execFile)\s*\(\s*.*\)',
    r'(?i)Runtime\.getRuntime\(\)\.exec\s*\(\s*.*\)',
    r'(?i)ProcessBuilder\s*\(\s*.*\)',
    r'(?i)\`[^\`]+\`',
    r'(?i)%x\{[^}]+\}',
    r'(?i)IO\.popen\s*\(\s*.*\)',
    r'(?i)popen\s*\(\s*.*\)',
    r'(?i)system\s*\(\s*.*\)',
    r'(?i)passthru\s*\(\s*.*\)',
    r'(?i)shell_exec\s*\(\s*.*\)',
    r'(?i)open\s*\(\s*.*\)',
    r'(?i)\|\s*\w+',
    r'(?i);\s*\w+',
    r'(?i)&\s*\w+',
    r'(?i)\$\(.*\)',
    r'(?i)\$\w+',
    r'(?i)\bcat\b|\bgrep\b|\bwget\b|\bcurl\b|\bftp\b|\bscp\b|\bssh\b|\bpython\b|\bperl\b|\bphp\b|\bnode\b|\bjava\b|\bawk\b|\bsed\b|\bnetcat\b|\bnc\b',
]
